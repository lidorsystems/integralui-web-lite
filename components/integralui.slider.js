/*
  filename: integralui.slider.js
  version : 20.2.0
  Copyright Â© 2020 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web Lite" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web Lite License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/lite/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
import{c as css,h as html}from"../external/lit-element.js";import{c as classMap}from"../external/class-map.js";import{s as styleMap}from"../external/style-map.js";import{IntegralUIOrientation,IntegralUIObjectState,IntegralUITheme}from"./integralui.enums.js";import IntegralUIBaseValue from"./integralui.base.value.js";import{iuiSliderDefaultStyle}from"../styles/integralui.slider.style.js";import{iuiSliderOfficeStyle}from"../themes/office/integralui.slider.office.js";import{iuiSliderMidnightStyle}from"../themes/midnight/integralui.slider.midnight.js";class IntegralUISlider extends IntegralUIBaseValue{_ini(){super._ini();this._ctrMxVl=100;this._ctrMnVl=0;this._cVal=0;this._sldCgAct=!1;this._cOrn=IntegralUIOrientation.Horizontal;this._cntSz={width:0,height:0};this._hdlSz={width:0,height:0};this._sldSz={width:0,height:0};this._sldPs=0;this._cCtrStyStt=iuiSliderDefaultStyle;this._sldBkCs={};this._sldBtnCs={};this._gnrCsNm="iui-slider";this._cntCSName=this._gnrCsNm+"-content";this._sldBkCsName=this._gnrCsNm+"-background";this._sldBtnCsName=this._gnrCsNm+"-button";this._iniStyle()}_iniStyle(){this._dfSty={general:{disabled:this._gnrCsNm+"-disabled",focused:this._gnrCsNm+"-focused",normal:this._gnrCsNm,hovered:this._gnrCsNm+"-hovered",selected:this._gnrCsNm+"-selected"},content:{disabled:this._cntCSName+"-disabled",focused:this._cntCSName+"-focused",normal:this._cntCSName,hovered:this._cntCSName+"-hovered",selected:this._cntCSName+"-selected"},slider:{background:{disabled:this._sldBkCsName+"-disabled",focused:this._sldBkCsName+"-focused",normal:this._sldBkCsName,hovered:this._sldBkCsName+"-hovered",selected:this._sldBkCsName+"-selected"},button:{disabled:this._sldBtnCsName+"-disabled",focused:this._sldBtnCsName+"-focused",normal:this._sldBtnCsName,hovered:this._sldBtnCsName+"-hovered",selected:this._sldBtnCsName+"-selected"}}};this.refresh()}connectedCallback(){this._winMuMv=this._winMuMv.bind(this);window.addEventListener("mousemove",this._winMuMv);this._winMuUp=this._winMuUp.bind(this);window.addEventListener("mouseup",this._winMuUp)}disconnectedCallback(){window.removeEventListener("mousemove",this._winMuMv);window.removeEventListener("mouseup",this._winMuUp)}attributeChangedCallback(t,e,s){super.attributeChangedCallback(t,e,s)}static get properties(){return{max:{type:Number,reflect:!0},min:{type:Number,reflect:!0},orientation:{converter:{fromAttribute:t=>"horizontal"===(t=t.replace(/"|'/,"").replace(/"|'/,"")).toLowerCase()?IntegralUIOrientation.Horizontal:IntegralUIOrientation.Vertical,toAttribute:(t,e)=>t===IntegralUIOrientation.Horizontal?"Horizontal":"Vertical"},reflect:!0}}}get max(){return this._ctrMxVl}set max(t){t=Math.floor(t);if(this._ctrMxVl!==t){const e=this._ctrMxVl;this._ctrMxVl=t;this.requestUpdate("max",e)}}get min(){return this._ctrMnVl}set min(t){t=Math.floor(t);if(this._ctrMnVl!==t){const e=this._ctrMnVl;this._ctrMnVl=t;this.requestUpdate("min",e)}}get orientation(){return this._cOrn}set orientation(t){if(this._cOrn!==t){const e=this._cOrn;this._cOrn=t;this.requestUpdate("orientation",e);this.updateLayout()}}get value(){return Math.floor(this._cVal)}set value(t){t=Math.floor(t);if((t=Math.max(0,Math.min(this._ctrMxVl,t)))!==this._cVal&&t>=this._ctrMnVl&&t<=this._ctrMxVl){const e=this._cVal;this._cVal=t;this._inkEv("valueChanged",{value:this._cVal});this.requestUpdate("value",e);this.updateLayout()}}_gCntWh(){return this._cntSz.width}_gSldWh(){return this._sldSz.width}_prcUpLt(){let t=this;return new Promise(e=>{let s=setTimeout(function(){let i=t._cmnSrv.getPadding(t._eRf);t._clRc={width:t._eRf.clientWidth-(i.left+i.right),height:t._eRf.clientHeight-(i.top+i.bottom)};t._cntSz={width:t._clRc.width-2,height:t._clRc.height-2};t._sldSz={width:t._clRc.width-4,height:t._clRc.height-4};if(t._cOrn===IntegralUIOrientation.Horizontal){t._cntSz.height=1;t._sldSz.width=t._sldSz.height/2}else{t._cntSz.width=1;t._sldSz.height=t._sldSz.width/2}t._hdlSz={width:t._handleElem.offsetWidth,height:t._handleElem.offsetHeight};if(t._cVal<t._ctrMnVl||t._cVal>t._ctrMxVl)t._cVal=Math.max(t._ctrMnVl,Math.min(t._ctrMxVl,t._cVal));if(t._cOrn===IntegralUIOrientation.Horizontal)t._sldPs=t._cVal*(t._clRc.width-t._hdlSz.width)/t._ctrMxVl;else t._sldPs=t._cVal*(t._clRc.height-t._hdlSz.height)/t._ctrMxVl;t._upCntCs();t._uSldBCs();t.update();clearTimeout(s);e()},1)})}_ctrMuEnt(t){this._animationState="in"}_ctrMuLv(t){if(!this._sldCgAct)this._animationState="out"}_ctrMuDn(t){if(this._enbl&&1===t.which){this._sldCgAct=!0;if(this._cOrn===IntegralUIOrientation.Horizontal){if(this._clRc.width>0)this.value=this._ctrMxVl*t.offsetX/this._clRc.width}else if(this._clRc.height>0)this.value=this._ctrMxVl*(this._clRc.height-t.offsetY)/this._clRc.height;t.stopPropagation()}}_ctrMuMv(t){this._animationState="in"}_ctrMuUp(t){this._sldCgAct=!1}_ctrMuWh(t){if(this._enbl){t.preventDefault();let e=Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)),s=(this._ctrMxVl-this._ctrMnVl)/10;this.value+=s*e*-1;t.stopPropagation()}}_ctrTchEd(t){if(this._enbl){let e=this._cmnSrv.getTouchData(t);if(e&&e.length>0){let s=this._cmnSrv.getPageRect(this._eRf),i=this._cmnSrv.getShiftPos();if(this._cOrn===IntegralUIOrientation.Horizontal){if(this._clRc.width>0)this.value=this._ctrMxVl*(e[0].pageX-s.left-i.x)/this._clRc.width}else if(this._clRc.height>0)this.value=this._ctrMxVl*(this._clRc.height-(e[0].pageY-s.bottom-i.y))/this._clRc.height;t.stopPropagation()}}}_winMuMv(t){if(this._enbl&&1===t.which&&this._sldCgAct){let e=this._cmnSrv.getMousePos(t),s=this._cmnSrv.getShiftPos();e.x-=s.x;e.y-=s.y;let i=this._cmnSrv.getPageRect(this._eRf),l=0;if(this._cOrn===IntegralUIOrientation.Horizontal){if(e.x<i.left)l=this._ctrMnVl;else if(e.x>i.right)l=this._ctrMxVl;else if(this._clRc.width>0)l=this._ctrMxVl*(e.x-i.left)/this._clRc.width}else if(e.y>i.bottom)l=this._ctrMnVl;else if(e.y<i.top)l=this._ctrMxVl;else if(this._clRc.height>0)l=this._ctrMxVl*(i.bottom-e.y)/this._clRc.height;this.value=l;t.stopPropagation()}}_winMuUp(t){this._sldCgAct=!1;this._animationState="out"}_gSldBSty(){let t={position:"absolute"};if(this._cOrn===IntegralUIOrientation.Horizontal)Object.assign(t,{left:this._sldPs+this._hdlSz.width+"px",top:this._clRc.height/2+"px",width:this._cntSz.width-this._sldPs-this._hdlSz.width+"px"});else Object.assign(t,{left:this._clRc.width/2+"px",bottom:this._sldPs+this._hdlSz.height+"px",height:this._cntSz.height-this._sldPs-this._hdlSz.height+"px"});return t}_gSldBVSty(){let t={position:"absolute"};if(this._cOrn===IntegralUIOrientation.Horizontal)Object.assign(t,{left:"0",top:this._clRc.height/2+"px",width:this._sldPs+"px"});else Object.assign(t,{left:this._clRc.width/2+"px",bottom:"0",height:this._sldPs+"px"});return t}_gSldVSty(){let t={position:"absolute"};if(this._cOrn===IntegralUIOrientation.Horizontal)Object.assign(t,{left:this._sldPs+"px",top:"0",width:this._sldSz.width+"px",height:this._sldSz.height+"px"});else Object.assign(t,{left:"0",bottom:this._sldPs+"px",width:this._sldSz.width+"px",height:this._sldSz.height+"px"});return t}_upCntCs(){this._cntCS={};if(this._cOrn===IntegralUIOrientation.Horizontal)this._cntCS[this._cntCSName]=!0;else this._cntCS[this._cntCSName+"-vertical"]=!0;if(this._opt.currentStyle){this._cntCS[this._opt.currentStyle.content.normal]=!0;if(this.state&IntegralUIObjectState.Disabled)this._cntCS[this._opt.currentStyle.content.disabled]=!0;else if(this.state&IntegralUIObjectState.focused)this._cntCS[this._opt.currentStyle.content.focused]=!0;else if(this.state&IntegralUIObjectState.selected)this._cntCS[this._opt.currentStyle.content.selected]=!0;else if(this.state&IntegralUIObjectState.hovered)this._cntCS[this._opt.currentStyle.content.hovered]=!0}}_gSldBgCs(){return this._sldBkCs}_uSldBCs(){this._sldBkCs={};if(this._cOrn===IntegralUIOrientation.Horizontal)this._sldBkCs[this._sldBkCsName]=!0;else this._sldBkCs[this._sldBkCsName+"-vertical"]=!0;if(this._opt.currentStyle){this._sldBkCs[this._opt.currentStyle.slider.background.normal]=!0;if(this.state&IntegralUIObjectState.Disabled)this._sldBkCs[this._opt.currentStyle.slider.background.disabled]=!0;else if(this.state&IntegralUIObjectState.focused)this._sldBkCs[this._opt.currentStyle.slider.background.focused]=!0;else if(this.state&IntegralUIObjectState.selected)this._sldBkCs[this._opt.currentStyle.slider.background.selected]=!0;else if(this.state&IntegralUIObjectState.hovered)this._sldBkCs[this._opt.currentStyle.slider.background.hovered]=!0}}_gSldBtnCs(){return this._sldBtnCs}_uSldBtnCs(){this._sldBtnCs={};this._sldBtnCs[this._sldBtnCsName]=!0;if(this._opt.currentStyle){this._sldBtnCs[this._opt.currentStyle.slider.button.normal]=!0;if(this.state&IntegralUIObjectState.Disabled)this._sldBtnCs[this._opt.currentStyle.slider.button.disabled]=!0;else if(this.state&IntegralUIObjectState.focused)this._sldBtnCs[this._opt.currentStyle.slider.button.focused]=!0;else if(this.state&IntegralUIObjectState.selected)this._sldBtnCs[this._opt.currentStyle.slider.button.selected]=!0;else if(this.state&IntegralUIObjectState.hovered)this._sldBtnCs[this._opt.currentStyle.slider.button.hovered]=!0}}_gSldBgSty(t){if(this._cmnSrv.isString(t))return t;else if(t)return{disabled:this._cmnSrv.isFieldAvailable(t.disabled,this._sldBkCsName+"-disabled"),focused:this._cmnSrv.isFieldAvailable(t.focused,this._sldBkCsName+"-focused"),hovered:this._cmnSrv.isFieldAvailable(t.hovered,this._sldBkCsName+"-hovered"),normal:this._cmnSrv.isFieldAvailable(t.normal,this._sldBkCsName),selected:this._cmnSrv.isFieldAvailable(t.selected,this._sldBkCsName+"-selected")};else return{disabled:this._dfSty.slider.background.disabled,focused:this._dfSty.slider.background.focused,hovered:this._dfSty.slider.background.hovered,normal:this._dfSty.slider.background.normal,selected:this._dfSty.slider.background.selected}}_gSldBtnSty(t){if(this._cmnSrv.isString(t))return t;else if(t)return{disabled:this._cmnSrv.isFieldAvailable(t.disabled,this._sldBtnCsName+"-disabled"),focused:this._cmnSrv.isFieldAvailable(t.focused,this._sldBtnCsName+"-focused"),hovered:this._cmnSrv.isFieldAvailable(t.hovered,this._sldBtnCsName+"-hovered"),normal:this._cmnSrv.isFieldAvailable(t.normal,this._sldBtnCsName),selected:this._cmnSrv.isFieldAvailable(t.selected,this._sldBtnCsName+"-selected")};else return{disabled:this._dfSty.slider.button.disabled,focused:this._dfSty.slider.button.focused,hovered:this._dfSty.slider.button.hovered,normal:this._dfSty.slider.button.normal,selected:this._dfSty.slider.button.selected}}_gSldSty(t){if(this._cmnSrv.isString(t))return t;else if(t)return{background:this._gSldBgSty(t.background),button:this._gSldBtnSty(t.button)};else return{background:{disabled:this._dfSty.slider.background.disabled,focused:this._dfSty.slider.background.focused,hovered:this._dfSty.slider.background.hovered,normal:this._dfSty.slider.background.normal,selected:this._dfSty.slider.background.selected},button:{disabled:this._dfSty.slider.button.disabled,focused:this._dfSty.slider.button.focused,hovered:this._dfSty.slider.button.hovered,normal:this._dfSty.slider.button.normal,selected:this._dfSty.slider.button.selected}}}_uSty(t){if(t)this._opt.currentStyle={general:this._gGnSty(t.general),content:this._gCntSty(t.content),slider:this._gSldSty(t.slider)};else this._opt.currentStyle={general:{disabled:this._dfSty.general.disabled,focused:this._dfSty.general.focused,hovered:this._dfSty.general.hovered,normal:this._dfSty.general.normal,selected:this._dfSty.general.selected},content:{disabled:this._dfSty.content.disabled,focused:this._dfSty.content.focused,hovered:this._dfSty.content.hovered,normal:this._dfSty.content.normal,selected:this._dfSty.content.selected},slider:this._gSldSty()}}refresh(){this._uSty(this.controlStyle);this._uCtrCs();this._upCntCs();this._uSldBCs();this._uSldBtnCs();this.update();this._uRf()}_uThSt(t){this._cThmSettings=css``;switch(t){case IntegralUITheme.Office:this._cThmSettings.cssText=this._cmnSrv.replaceAll(iuiSliderOfficeStyle.cssText,"../icons",this._cRsPt);break;case IntegralUITheme.Midnight:this._cThmSettings.cssText=this._cmnSrv.replaceAll(iuiSliderMidnightStyle.cssText,"../icons",this._cRsPt);break;default:this._cThmSettings.cssText=""}}firstUpdated(t){this._uRf();this.updateLayout()}render(){return html`\n            <style>\n                ${this._cCtrStyStt}\n                ${this._cCmSty}\n                ${this._cThmSettings}\n            </style>\n            <div data-ctrl="slider" class=${classMap(this._gCtrCs())} style=${styleMap(this._gCtrSty())} draggable="true" @dragstart="${t=>this._prvDgSt(t)}" @mouseenter="${t=>this._ctrMuEnt(t)}" @mouseleave="${t=>this._ctrMuLv(t)}" @mousedown="${t=>this._ctrMuDn(t)}" @mousemove="${t=>this._ctrMuMv(t)}" @mouseup="${t=>this._ctrMuUp(t)}" @DOMMouseScroll="${t=>this._ctrMuWh(t)}" @mousewheel="${t=>this._ctrMuWh(t)}" @touchend="${t=>this._ctrTchEd(t)}">\n                <div class=${classMap(this._gCntCs())} style=${styleMap(this._gSldBSty())}></div>\n                <div class=${classMap(this._gSldBgCs())} style=${styleMap(this._gSldBVSty())}></div>\n                <div id="handle" class=${classMap(this._gSldBtnCs())} style=${styleMap(this._gSldVSty())}></div>\n            </div>\n        `}_uCtrStyStt(t){this._cCtrStyStt=css``;this._cCtrStyStt.cssText=this._cmnSrv.replaceAll(iuiSliderDefaultStyle.cssText,"../icons",t)}_uRf(){this._eRf=this.shadowRoot.querySelector("div[data-ctrl=slider]");this._handleElem=this.shadowRoot.querySelector("#handle")}}window.customElements.define("iui-slider",IntegralUISlider);export default IntegralUISlider;