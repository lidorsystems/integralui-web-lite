/*
  filename: integralui.splitter.js
  version : 20.2.0
  Copyright Â© 2020 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web Lite" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web Lite License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/lite/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
import{c as css,h as html}from"../external/lit-element.js";import{c as classMap}from"../external/class-map.js";import{s as styleMap}from"../external/style-map.js";import{IntegralUIOrientation,IntegralUITheme}from"./integralui.enums.js";import IntegralUIBase from"./integralui.base.js";import{iuiSplitterDefaultStyle}from"../styles/integralui.splitter.style.js";import{iuiSplitterOfficeStyle}from"../themes/office/integralui.splitter.office.js";import{iuiSplitterMidnightStyle}from"../themes/midnight/integralui.splitter.midnight.js";class IntegralUISplitter extends IntegralUIBase{_ini(){super._ini();this._splAct=!1;this._mxPs={x:9999999,y:9999999};this._cOrn=IntegralUIOrientation.Horizontal;this._ctrRc={top:0,right:0,bottom:0,left:0,height:0,width:0,x:0,y:0};this._cSplDst=100;this._splDstDef=!1;this._pn1Brd={top:0,right:0,bottom:0,left:0};this._pn2Brd={top:0,right:0,bottom:0,left:0};this._pnl1Sz={width:0,height:0};this._pnl2Sz={width:0,height:0};this._splSz={width:0,height:0};this._splHdSz={width:0,height:0};this._splStPs={x:0,y:0};this._cCtrStyStt=iuiSplitterDefaultStyle;this._hdCs={};this._pnCs={};this._splCs={};this._iniStyle()}connectedCallback(){this._winMuUp=this._winMuUp.bind(this);window.addEventListener("mouseup",this._winMuUp)}disconnectedCallback(){window.removeEventListener("mouseup",this._winMuUp)}_iniStyle(){this._gnrCsNm="iui-splitter";this._hdCsName=this._gnrCsNm+"-handle";this._pnCsName=this._gnrCsNm+"-panel";this._splCsName=this._gnrCsNm+"-bar";this._dfSty={general:{disabled:this._gnrCsNm+"-disabled",focused:this._gnrCsNm+"-focused",normal:this._gnrCsNm,hovered:this._gnrCsNm+"-hovered",selected:this._gnrCsNm+"-selected"},panel:{disabled:this._pnCsName+"-disabled",normal:this._pnCsName+"-normal"},splitter:{general:{normal:this._splCsName,horizontal:this._splCsName+"-horizontal",vertical:this._splCsName+"-vertical"},handle:{general:this._hdCsName,horizontal:this._hdCsName+"-horizontal",vertical:this._hdCsName+"-vertical"}}};this._uSty(this._controlStyle);this.refresh()}attributeChangedCallback(t,i,e){super.attributeChangedCallback(t,i,e)}static get properties(){return{orientation:{converter:{fromAttribute:t=>"horizontal"===(t=t.replace(/"|'/,"").replace(/"|'/,"")).toLowerCase()?IntegralUIOrientation.Horizontal:IntegralUIOrientation.Vertical,toAttribute:(t,i)=>t===IntegralUIOrientation.Horizontal?"Horizontal":"Vertical"},reflect:!0},panel1:{type:Object},panel2:{type:Object},splitterDistance:{type:Number,attribute:"splitter-distance",reflect:!0}}}get orientation(){return this._cOrn}set orientation(t){if(this._cOrn!==t){const i=this._cOrn;let e=this,s=setTimeout(function(){e._cOrn=t;e.requestUpdate("orientation",i);e.splitterDistance=e._kpSplPRg(e.splitterDistance);e.refresh();e.updateLayout();clearTimeout(s)},1)}}get splitterDistance(){return this._cSplDst}set splitterDistance(t){if(this._cSplDst!==t){const i=this._cSplDst;let e=this;e._splDstDef=!0;let s=setTimeout(function(){e._cSplDst=e._kpSplPRg(t);e.requestUpdate("splitterDistance",i);e.updateLayout();e._inkEv("splitterMoved",{value:t});clearTimeout(s)},1)}}_kpSplPRg(t){return this.orientation===IntegralUIOrientation.Vertical?Math.max(0,Math.min(Math.max(0,t),this._mxPs.x)):Math.max(0,Math.min(Math.max(0,t),this._mxPs.y))}async updateLayout(){await this._uCtrLy();this.update()}_uCtrLy(){return new Promise(t=>{let i=this,e=setTimeout(function(){i._splSz={width:i._splitterElem.offsetWidth,height:i._splitterElem.offsetHeight};i._clRc={width:i._eRf.clientWidth-2,height:i._eRf.clientHeight-2};if(!i._splDstDef)i._cSplDst=i.orientation===IntegralUIOrientation.Vertical?Math.floor(i._clRc.width-i._splSz.width)/2:Math.floor(i._clRc.height-i._splSz.height)/2;i._pn1Brd=i._cmnSrv.getBorderWidth(i._panel1Elem);i._pn2Brd=i._cmnSrv.getBorderWidth(i._panel2Elem);i._pnl1Sz={width:i._cSplDst,height:i._cSplDst+i._pn1Brd.top+i._pn1Brd.bottom};i._pnl2Sz={width:i._clRc.width-i._cSplDst-i._splSz.width,height:i._clRc.height-i._cSplDst-i._splSz.height};if(i.orientation===IntegralUIOrientation.Vertical)i._mxPs={x:i._clRc.width-i._splSz.width,y:i._clRc.height-i._splSz.width};else i._mxPs={x:i._clRc.width-i._splSz.height,y:i._clRc.height-i._splSz.height};i._splHdSz={width:i._handleElem.offsetWidth,height:i._handleElem.offsetHeight};clearTimeout(e);t()},i._splAct?1:50)})}_ctrMuMv(t){if(this._enbl&&1===t.buttons&&this._splAct){let i=this._cmnSrv.getShiftPos(),e={x:t.pageX-this._ctrRc.left-i.x,y:t.pageY-this._ctrRc.top-i.y},s=this._cSplDst;if(this.orientation===IntegralUIOrientation.Vertical){s+=e.x-this._splStPs.x;s=Math.min(Math.max(0,s),this._mxPs.x)}else{s+=e.y-this._splStPs.y;s=Math.min(Math.max(0,s),this._mxPs.y)}if(this._cSplDst!==s){this._splDstDef=!0;let t={cancel:!1,value:s};this._inkEv("splitterMoving",t,!1);if(!0!==t.cancel){this._cSplDst=s;this.updateLayout()}}this._splStPs=e}}_splMuDn(t){if(this._enbl){let i=this._cmnSrv.getShiftPos(),e={x:t.pageX-this._ctrRc.left-i.x,y:t.pageY-this._ctrRc.top-i.y};if(this.orientation===IntegralUIOrientation.Vertical){this._splStPs=e;this._splAct=!0}else{this._splStPs=e;this._splAct=!0}}}_winMuUp(t){if(this._enbl){this._splAct=!1;this._inkEv("splitterMoved",{value:this._cSplDst})}}_chgOrn(t){this.orientation=t?IntegralUIOrientation.Vertical:IntegralUIOrientation.Horizontal}_gIPn1Sty(){let t={top:"0",left:"0",width:"100%",height:"100%"};if(this.orientation===IntegralUIOrientation.Vertical){t.width=this._pnl1Sz.width+"px";t.height=this._clRc.height+"px"}else{t.width=this._clRc.width+"px";t.height=this._pnl1Sz.height+"px"}return t}_gIPn2Sty(){let t={top:"0",left:"0",width:"100%",height:"100%"};if(this.orientation===IntegralUIOrientation.Vertical){t.left=this._pnl1Sz.width+this._splSz.width+"px";t.width=this._pnl2Sz.width+"px";t.height=this._clRc.height+"px"}else{t.width=this._clRc.width+"px";t.height=this._pnl2Sz.height-(this._pn2Brd.left+this._pn2Brd.right)+"px";t.top=this._pnl1Sz.height+this._splSz.height+"px"}return t}_gISplSty(){let t={top:"0",left:"0",width:"auto",height:"auto"};if(this.orientation===IntegralUIOrientation.Vertical){t.left=this._pnl1Sz.width+1+"px";t.height=this._clRc.height+"px"}else{t.width=this._clRc.width+"px";t.top=this._pnl1Sz.height+1+"px"}return t}_gIHdSty(){let t={"margin-top":"0","margin-left":"0"};if(this.orientation===IntegralUIOrientation.Vertical)t["margin-top"]=(this._splitterBlockSize.height-this._splHdSz.height)/2+"px";else t["margin-left"]=(this._splitterBlockSize.width-this._splHdSz.width)/2+"px";return t}_uSplCs(){this._splCs={};this._splCs[this._splCsName]=!0;this._splCs[this._opt.currentStyle.splitter.general.normal]=!0;if(this.orientation===IntegralUIOrientation.Vertical)this._splCs[this._opt.currentStyle.splitter.general.vertical]=!0;else this._splCs[this._opt.currentStyle.splitter.general.horizontal]=!0}_gSplCs(){return this._splCs}_uHdCs(){this._hdCs={};this._hdCs[this._hdCsName]=!0;this._hdCs[this._opt.currentStyle.splitter.handle.general]=!0;if(this.orientation===IntegralUIOrientation.Vertical)this._hdCs[this._opt.currentStyle.splitter.handle.vertical]=!0;else this._hdCs[this._opt.currentStyle.splitter.handle.horizontal]=!0}_gHdCs(){return this._hdCs}_uPnCs(){this._pnCs={};this._pnCs[this._pnCsName]=!0;this._pnCs[this._opt.currentStyle.panel.normal]=!0}_gPnCs(){return this._pnCs}_gPnSty(t){if(this._cmnSrv.isString(t))return t;else if(t)return{disabled:this._cmnSrv.isFieldAvailable(t.disabled,this._pnCsName+"-disabled"),normal:this._cmnSrv.isFieldAvailable(t.normal,this._pnCsName)};else return{disabled:this._dfSty.panel.disabled,normal:this._dfSty.panel.normal}}_gSplGnSty(t){if(this._cmnSrv.isString(t))return t;else if(t)return{normal:this._cmnSrv.isFieldAvailable(t.normal,this._splCsName),horizontal:this._cmnSrv.isFieldAvailable(t.horizontal,this._splCsName+"-horizontal"),vertical:this._cmnSrv.isFieldAvailable(t.vertical,this._splCsName+"-vertical")};else return{normal:this._dfSty.splitter.general.normal,horizontal:this._dfSty.splitter.general.horizontal,vertical:this._dfSty.splitter.general.vertical}}_gHdSty(t){if(this._cmnSrv.isString(t))return t;else if(t)return{general:this._cmnSrv.isFieldAvailable(t.general,this._hdCsName),horizontal:this._cmnSrv.isFieldAvailable(t.horizontal,this._hdCsName+"-horizontal"),vertical:this._cmnSrv.isFieldAvailable(t.vertical,this._hdCsName+"-vertical")};else return{general:this._dfSty.splitter.handle.general,horizontal:this._dfSty.splitter.handle.horizontal,vertical:this._dfSty.splitter.handle.vertical}}_gSplSty(t){if(this._cmnSrv.isString(t))return t;else if(t)return{general:this._gSplGnSty(t.general),handle:this._gHdSty(t.handle)};else return this._gDfSplSty()}_gDfSty(){return{general:this._gDfGnSty(),panel:this._gDfPnSty(),splitter:this._gDfSplSty()}}_gDfPnSty(){return{disabled:this._dfSty.panel.disabled,normal:this._dfSty.panel.normal}}_gDfSplSty(){return{general:{normal:this._dfSty.splitter.general.normal,horizontal:this._dfSty.splitter.general.horizontal,vertical:this._dfSty.splitter.general.vertical},handle:{general:this._dfSty.splitter.handle.general,horizontal:this._dfSty.splitter.handle.horizontal,vertical:this._dfSty.splitter.handle.vertical}}}_uSty(t){if(t)this._opt.currentStyle={general:this._gGnSty(t.general),panel:this._gPnSty(t.panel),splitter:this._gSplSty(t.splitter)};else this._opt.currentStyle=this._gDfSty()}_uThSt(t){this._cThmSettings=css``;switch(t){case IntegralUITheme.Office:this._cThmSettings.cssText=this._cmnSrv.replaceAll(iuiSplitterOfficeStyle.cssText,"../icons",this._cRsPt);break;case IntegralUITheme.Midnight:this._cThmSettings.cssText=this._cmnSrv.replaceAll(iuiSplitterMidnightStyle.cssText,"../icons",this._cRsPt);break;default:this._cThmSettings.cssText=""}}firstUpdated(t){this._uRf();this.updateLayout()}refresh(){this._uCtrCs();this._uHdCs();this._uSplCs();this._uPnCs();this.update();this._uRf()}render(){return html`\n            <style>\n                ${this._cCtrStyStt}\n                ${this._cCmSty}\n                ${this._cThmSettings}\n            </style>\n            <div data-ctrl="splitter" class=${classMap(this._gCtrCs())} style=${styleMap(this._gCtrSty())} @mousemove="${t=>this._ctrMuMv(t)}">\n                <div id="panel1" class=${classMap(this._gPnCs())} style=${styleMap(this._gIPn1Sty())}>\n                    <slot name="iui-panel1"></slot>\n                </div>\n				<div id="splitter-bar" class=${classMap(this._gSplCs())} style=${styleMap(this._gISplSty())} @mousedown="${t=>this._splMuDn(t)}">\n					<span id="handle" class=${classMap(this._gHdCs())}></span>\n				</div>\n                <div id="panel2" class=${classMap(this._gPnCs())} style=${styleMap(this._gIPn2Sty())}>\n                    <slot name="iui-panel2"></slot>\n                </div>\n            </div>\n        `}_uCtrStyStt(t){this._cCtrStyStt=css``;this._cCtrStyStt.cssText=this._cmnSrv.replaceAll(iuiSplitterDefaultStyle.cssText,"../icons",t)}_uRf(){this._eRf=this.shadowRoot.querySelector("div[data-ctrl=splitter]");this._handleElem=this.shadowRoot.querySelector("#handle");this._panel1Elem=this.shadowRoot.querySelector("#panel1");this._panel2Elem=this.shadowRoot.querySelector("#panel2");this._splitterElem=this.shadowRoot.querySelector("#splitter-bar");this._ctrRc=this._cmnSrv.getPageRect(this._eRf)}}window.customElements.define("iui-splitter",IntegralUISplitter);export default IntegralUISplitter;